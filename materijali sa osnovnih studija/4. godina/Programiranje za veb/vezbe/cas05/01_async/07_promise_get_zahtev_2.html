<!-- mzoemo dodatno da unapredimo get tako sto ne koristimo onreadystatechange
zatos to je i to neki callback poziv
Pogledaj ako okaci jos neki dodatni primer u materijalima-->

<!DOCTYPE html>
<html lang="en"> 
<head>
    <meta charset="UTF-8">
    <title> Asinhrono prigramiranje </title>
</head>
<body>
    <h3> Studenti </h3>
    <script type="text/javascript">

        // umesto da korsitimo XMLHttpRequest objekat, mozemo da koristimo ugradjenu fetch() funkciju
        // koju implementiraju veb pregledaci (?) Ona radi isto sto i XMLHttpRequest samo sto se ne vraca JSON
        // nego promise
        function httpGet(url){
            // po defaultu fetch salje get zahev, ali ako nam treba drugo imamo opcioni argument
            // kada se fetch zavrsi on vraca promise koji mi onda obradimo na neki nacin, a ono sto ce 
            // nasa httpGet da vrati u ovom slucaju je taj obradjeni odgovor iz fetch
            // objekat koji vrati fetch ima metod .json() koji od tog sadrzaja pravi promise
            // zanaci ovde smo dobili promise od fetch, izvadili smo njegov sadrzaj u response, onda smo taj sadrzaj
            // ponovo zapakovali u promise i taj promise smo vratili kao izlaz iz httpGet
            return fetch(url).then(function(response){
                return response.json();
            });
        }


        httpGet('./07_students.json')
            .then(function(students){
                for (const student of students){
                    const node = document.createElement("p");
                    node.appendChild(
                        document.createTextNode(`${student.name} ${student.surname} ${student.index}`)
                    );
                    document.body.appendChild(node);
                }
            })
            .catch(function(err){
                console.log("Doslo je do greske: " + err.message);
            });

    </script>
</body>
</html>